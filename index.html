<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Instituto Digital Moisés Avelino</title>
  <link rel="icon" type="image/png" href="favicon.png">
  <style>
    body { font-family: Arial, sans-serif; margin:0; padding:0; background:#f5f9ff; color:#333;}
    header { background:#004aad; color:white; padding:10px 20px; display:flex; align-items:center; justify-content:space-between;}
    header img.logo { height:50px; }
    header .social img { height:32px; margin-left:15px; cursor:pointer; }
    main { padding:20px; max-width:900px; margin:auto;}
    h1 { text-align:center; color:#004aad;}
    form { background:white; padding:20px; border-radius:8px; box-shadow:0 0 10px rgba(0,0,0,0.1);}
    fieldset { border:1px solid #ddd; margin-bottom:15px; padding:15px; border-radius:8px;}
    legend { font-weight:bold; color:#004aad;}
    label { display:block; margin-top:10px; font-weight:bold;}
    input, select, textarea { width:100%; padding:8px; margin-top:5px; border:1px solid #ccc; border-radius:5px;}
    textarea { resize:vertical;}
    button { background:#004aad; color:white; border:none; padding:12px; width:100%; border-radius:5px; cursor:pointer; font-size:16px;}
    button:hover { background:#003080;}
    footer { background:#004aad; color:white; text-align:center; padding:15px; margin-top:20px;}
    footer img { height:28px; margin-top:8px; cursor:pointer;}
  </style>
</head>
<body>
  <header>
    <img src="logo.jpeg" alt="Instituto Digital Moisés Avelino" class="logo">
    <div class="social">
      <a href="https://www.instagram.com/instituto_moises_avelino_?igsh=MTV4dXM1ODI0eWExeQ%3D%3D&utm_source=qr" target="_blank">
        <img src="instagram.jpeg" alt="Instagram">
      </a>
    </div>
  </header>
  <main>
    <h1>Solicitação de Serviço</h1>
    <form id="servicoForm">
      <fieldset>
        <legend>Cliente</legend>
        <label>Nome do Cliente</label>
        <input type="text" name="cliente">
        <label>CRO</label>
        <input type="text" name="cro">
        <label>CPF/CNPJ</label>
        <input type="text" name="cpfcnpj">
        <label>Endereço</label>
        <input type="text" name="endereco">
        <label>Telefone</label>
        <input type="text" name="telefone">
      </fieldset>
      <fieldset>
        <legend>Paciente</legend>
        <label>Nome do Paciente</label>
        <input type="text" name="paciente">
      </fieldset>
      <fieldset>
        <legend>Serviço</legend>
        <label>Tipo de Serviço</label>
        <select name="servico">
          <option>Protocolo</option>
          <option>Coroa</option>
          <option>Faceta</option>
          <option>Bloco</option>
        </select>
        <label>Material</label>
        <select name="material">
          <option>Zircônia</option>
          <option>Emax</option>
          <option>PMMA</option>
        </select>
        <label>Cor</label>
        <input type="text" name="cor">
        <label>Observações</label>
        <textarea name="obs"></textarea>
      </fieldset>
      <fieldset>
        <legend>Anexos</legend>
        <input type="file" id="arquivos" name="arquivos" accept=".stl,.ply" multiple>
      </fieldset>
      <button type="submit">Enviar Solicitação</button>
    </form>
    <p style="text-align:center; margin-top:20px;">
      <a href="tabela_servicos.jpeg" download>Tabela de Serviços</a>
    </p>
  </main>
  <footer>
    <p>Contato WhatsApp: (71) 99286-3990</p>
    <a href="https://www.instagram.com/instituto_moises_avelino_?igsh=MTV4dXM1ODI0eWExeQ%3D%3D&utm_source=qr" target="_blank">
      <img src="instagram.jpeg" alt="Instagram">
    </a>
  </footer>
  <script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>
  <script>
    (function() {
      emailjs.init("cDfXutPGgZv2avweb");
    })();

    document.getElementById("arquivos").addEventListener("change", function(e) {
      for (let file of e.target.files) {
        if (file.size > 50 * 1024 * 1024) {
          alert("❌ O arquivo " + file.name + " ultrapassa 50MB!");
          e.target.value = "";
          return;
        }
        if (!file.name.endsWith(".stl") && !file.name.endsWith(".ply")) {
          alert("❌ Apenas arquivos .stl ou .ply são permitidos.");
          e.target.value = "";
          return;
        }
      }
    });

    document.getElementById("servicoForm").addEventListener("submit", function(e) {
      e.preventDefault();
      const formData = new FormData(e.target);
      let data = {};
      formData.forEach((value, key) => data[key] = value);

      // WhatsApp
      let msg = `Cliente: ${data.cliente}%0A CRO: ${data.cro}%0A CPF/CNPJ: ${data.cpfcnpj}%0A Endereço: ${data.endereco}%0A Telefone: ${data.telefone}%0A Paciente: ${data.paciente}%0A Serviço: ${data.servico}%0A Material: ${data.material}%0A Cor: ${data.cor}%0A Observações: ${data.obs}`;
      window.open(`https://wa.me/5571992863990?text=${msg}`, "_blank");

      // EmailJS
      emailjs.send("service_omrmh59","template_4hr7ydn",{
        cliente: data.cliente,
        cro: data.cro,
        cpfcnpj: data.cpfcnpj,
        endereco: data.endereco,
        telefone: data.telefone,
        paciente: data.paciente,
        servico: data.servico,
        material: data.material,
        cor: data.cor,
        obs: data.obs,
        reply_to: "centrodeusinagemmprotese@gmail.com"
      }).then(()=>{
        alert("Solicitação enviada com sucesso!");
      }).catch((err)=>{
        alert("Erro ao enviar: " + JSON.stringify(err));
      });
    });
  </script>
</body>
</html>